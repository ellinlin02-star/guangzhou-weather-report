<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>广州天气数据报告</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.6/dist/chart.umd.min.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js" crossorigin="anonymous"></script>
  <style>
    :root { --bg: #0f1419; --card: #1a2332; --text: #e6edf3; --muted: #8b949e; --accent: #58a6ff; --border: #30363d; --warn: #f85149; --ok: #3fb950; }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Microsoft YaHei", sans-serif; background: var(--bg); color: var(--text); line-height: 1.6; min-height: 100vh; }
    .container { max-width: 960px; margin: 0 auto; padding: 2rem 1rem; }
    header { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem; padding: 2rem 0 3rem; border-bottom: 1px solid var(--border); }
    header .header-text { flex: 1; min-width: 0; }
    header h1 { font-size: 1.75rem; font-weight: 700; margin: 0 0 0.5rem; color: var(--text); }
    header p { color: var(--muted); font-size: 0.95rem; margin: 0; }
    section { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem; margin-bottom: 2rem; }
    section.highlight-section { border-color: var(--accent); background: linear-gradient(135deg, rgba(26,35,50,0.98) 0%%, rgba(30,45,65,0.95) 100%%); }
    section h2 { font-size: 1.2rem; font-weight: 600; margin: 0 0 1rem; color: var(--accent); }
    .chart-wrap { margin: 1rem 0; position: relative; height: 280px; }
    .chart-wrap.chart-daily { height: 320px; }
    .chart-wrap canvas { border-radius: 8px; }
    .chart-wrap.chart-daily { padding: 12px; border-radius: 10px; background: linear-gradient(145deg, rgba(30,40,55,0.5) 0%%, rgba(26,35,50,0.3) 100%%); border: 1px solid rgba(48,54,61,0.5); }
    footer { text-align: center; padding: 2rem 1rem; color: var(--muted); font-size: 0.85rem; border-top: 1px solid var(--border); }
    .highlight { color: var(--accent); }
    .summary { color: var(--muted); font-size: 0.9rem; margin-top: 0.5rem; }
    .btn-download { display: inline-flex; align-items: center; gap: 0.4rem; padding: 0.5rem 1rem; font-size: 0.9rem; color: var(--accent); background: rgba(88,166,255,0.15); border: 1px solid var(--accent); border-radius: 8px; cursor: pointer; font-family: inherit; transition: background 0.2s, color 0.2s; flex-shrink: 0; }
    .btn-download:hover { background: rgba(88,166,255,0.25); color: var(--text); }
    .data-table-wrap { margin-bottom: 1.5rem; }
    .data-table-wrap h3 { font-size: 1rem; color: var(--accent); margin: 0 0 0.5rem; }
    .chart-subtitle { font-size: 1rem; font-weight: 600; color: var(--accent); margin: 1rem 0 0.25rem; }
    .data-table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
    .data-table th, .data-table td { padding: 0.4rem 0.6rem; text-align: left; border: 1px solid var(--border); }
    .data-table th { background: rgba(48,54,61,0.5); color: var(--muted); }
    .data-table tbody tr:hover td { background: rgba(88,166,255,0.08); }
    .report-module { margin-bottom: 3rem; }
    .report-module-title { font-size: 1.35rem; font-weight: 700; color: var(--text); margin: 0 0 1.25rem; padding-bottom: 0.75rem; border-bottom: 2px solid var(--accent); }
    .charts-row { display: flex; gap: 1rem; margin: 1rem 0; flex-wrap: wrap; }
    .charts-row .chart-cell { flex: 1 1 45%; min-width: 280px; }
    /* 智能客服聊天 */
    #chat-widget { position: fixed; bottom: 1.5rem; right: 1.5rem; z-index: 9999; font-family: inherit; }
    #chat-toggle { width: 56px; height: 56px; border-radius: 50%; border: 2px solid var(--accent); background: var(--card); color: var(--accent); cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; transition: transform 0.2s, background 0.2s; }
    #chat-toggle:hover { background: rgba(88,166,255,0.2); transform: scale(1.05); }
    #chat-panel { display: none; position: absolute; bottom: 70px; right: 0; width: 360px; max-width: calc(100vw - 2rem); max-height: 480px; background: var(--card); border: 1px solid var(--border); border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.4); flex-direction: column; overflow: hidden; }
    #chat-panel.open { display: flex; }
    #chat-header { padding: 0.75rem 1rem; background: rgba(88,166,255,0.15); border-bottom: 1px solid var(--border); font-weight: 600; color: var(--accent); display: flex; align-items: center; justify-content: space-between; }
    #chat-close { background: none; border: none; color: var(--muted); cursor: pointer; font-size: 1.2rem; padding: 0 0.25rem; line-height: 1; }
    #chat-close:hover { color: var(--text); }
    #chat-messages { flex: 1; overflow-y: auto; padding: 1rem; min-height: 200px; max-height: 320px; }
    .chat-msg { margin-bottom: 0.75rem; max-width: 90%; }
    .chat-msg.bot { margin-right: auto; }
    .chat-msg.user { margin-left: auto; }
    .chat-msg .bubble { padding: 0.6rem 0.9rem; border-radius: 12px; font-size: 0.9rem; line-height: 1.5; }
    .chat-msg.bot .bubble { background: rgba(48,54,61,0.6); border: 1px solid var(--border); color: var(--text); }
    .chat-msg.user .bubble { background: rgba(88,166,255,0.2); border: 1px solid var(--accent); color: var(--text); }
    #chat-quick { padding: 0 1rem 0.5rem; display: flex; flex-wrap: wrap; gap: 0.4rem; }
    #chat-quick button { padding: 0.35rem 0.6rem; font-size: 0.8rem; color: var(--accent); background: rgba(88,166,255,0.12); border: 1px solid var(--border); border-radius: 8px; cursor: pointer; font-family: inherit; }
    #chat-quick button:hover { background: rgba(88,166,255,0.2); }
    #chat-form { display: flex; padding: 0.75rem 1rem; border-top: 1px solid var(--border); gap: 0.5rem; }
    #chat-input { flex: 1; padding: 0.5rem 0.75rem; border: 1px solid var(--border); border-radius: 8px; background: var(--bg); color: var(--text); font-size: 0.9rem; font-family: inherit; }
    #chat-input:focus { outline: none; border-color: var(--accent); }
    #chat-send { padding: 0.5rem 1rem; background: var(--accent); color: #0f1419; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-family: inherit; font-size: 0.9rem; }
    #chat-send:hover { filter: brightness(1.1); }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="header-text">
        <h1>广州天气数据报告</h1>
        <p>广州（约 23.13&#176;N, 113.26&#176;E） · 2016-01-01 至 2025-12-31 · 生成时间 2026-02-19 05:46</p>
      </div>
      <button type="button" class="btn-download" id="btn-download-report" data-filename-xlsx="广州天气报告_表格数据_2026-02-19_05-46.xlsx" aria-label="下载表格数据">下载表格数据</button>
    </header>

    <div class="report-module">
      <h2 class="report-module-title">一、近期天气与预告</h2>
      
    <section class="highlight-section">
      <h2>今日天气与近期预告</h2>
      <p id="today-summary"><strong>今日（2026-02-19）温度范围：</strong> 14.0&#176;C ~ 22.9&#176;C</p>
      <p class="summary"><strong>昨日（2026-02-18）温度范围：</strong> 12.0&#176;C ~ 22.1&#176;C</p>
      <p class="summary" id="today-advice"><strong>温度建议：</strong>注意根据体感增减衣物。</p>
      <h3 class="chart-subtitle">今日逐时温度预告</h3>
      <p class="summary" id="hourly-today-note">打开页面时自动加载当前日期的逐时预报，悬停可看具体时刻与温度。</p>
      <div id="hourly-today-wrap" class="chart-wrap chart-daily" style="min-height: 200px;">
        <p id="hourly-loading" class="summary">正在加载今日逐时温度…</p>
        <canvas id="chart-hourly-today" aria-label="今日逐时气温" style="display: none;"></canvas>
      </div>
    </section>

    <section>
      <h3 class="chart-subtitle">未来 15 天天气预告</h3>
      <p id="forecast-loading" class="summary">正在加载当前日期的未来 15 天预报…</p>
      <div class="chart-wrap chart-daily" id="wrap-forecast" style="display: none;"><canvas id="chart-forecast" aria-label="未来15天预报"></canvas></div>
      <p class="summary">打开页面时自动按当前日期更新，数据来源：Open-Meteo Forecast API。</p>
    </section>
    </div>

    <div class="report-module">
      <h2 class="report-module-title">二、历史与年度分析</h2>
    <section>
      <h2>1. 2025 年天气情况</h2>
      <p>2025 年共 <strong>365</strong> 天。年均：最高温 27.29&#176;C，最低温 19.55&#176;C，平均温 22.97&#176;C。</p>
      <p>年度极值：最高温日 <span class="highlight">2025-09-05</span>（38.0&#176;C），最低温日 <span class="highlight">2025-02-09</span>（4.5&#176;C）。</p>
      <div class="chart-wrap chart-daily"><canvas id="chart-2025-daily" aria-label="2025年逐日气温"></canvas></div>
      <div class="chart-wrap"><canvas id="chart-2025" aria-label="2025年月度气温"></canvas></div>
    </section>

    <section>
      <h2>2. 近 10 年天气趋势（2016－2025）</h2>
      <p>近 10 年日均最高温均值 <strong>26.7&#176;C</strong>，最低温均值 <strong>19.58&#176;C</strong>，平均温 <strong>22.77&#176;C</strong>。年均温趋势约 <strong>0.5&#176;C/10 年</strong>。</p>
      <p class="summary">（趋势显著性检验需 scipy；安装后重新生成报告即可显示：pip install scipy。）</p>
      <div class="chart-wrap"><canvas id="chart-10y" aria-label="近10年气温趋势"></canvas></div>
    </section>

    <section>
      <h2>3. 异常天气（高温/低温异常天数）</h2>
      <p>高温异常：日最高温 ≥ 33.6&#176;C（95% 分位），共 <strong>187</strong> 天；低温异常：日最低温 ≤ 8.4&#176;C（5% 分位），共 <strong>189</strong> 天。</p>
      <div class="chart-wrap"><canvas id="chart-ab" aria-label="异常天气天数"></canvas></div>
    </section>

    <section>
      <h2>4. 2026 年预测（月均温）</h2>
      <p class="summary"><em>基于 2016-2025 年月均值，并叠加约 +0.1&#176;C 年际升温趋势（参考值；未做回归估计）。</em></p>
      <p class="summary">预测采用参考值 +0.1&#176;C/年；安装 scipy 后重新生成报告可改为基于回归估计的斜率。</p>
      <h3 class="chart-subtitle">每日温度预测</h3>
      <p class="summary">下图为由月均温插值得到的 2026 年逐日温度预测，悬停可看具体日期与数值。</p>
      <div class="chart-wrap chart-daily"><canvas id="chart-2026-daily" aria-label="2026年逐日预测"></canvas></div>
      <p class="summary">2026 年月度预测（月均最高温 / 平均温 / 最低温）：</p>
      <div class="chart-wrap"><canvas id="chart-2026" aria-label="2026年月度预测"></canvas></div>
      <p class="summary">注：仅供参考，不替代气象部门预报。</p>
    </section>

    <section>
      <h2>5. 2026 年冬夏季展望</h2>
      <p><strong>冬季（2025/26 冬）：</strong>接近常年，偏暖或偏冷幅度不大。</p>
      <p><strong>夏季（2026 年夏）：</strong>极端高温风险接近常年水平。</p>
      <p class="summary">以上基于 2016-2025 年月度统计与简单趋势，仅供参考，不替代气象部门预报。</p>
    </section>
    </div>

    <footer>
      <p>数据来源：Open-Meteo Archive API · 广州 · Asia/Shanghai</p>
    </footer>
  </div>
  <script>
(function() {
  var data = {"chart_2025_daily": {"labels": ["2025-01-01", "2025-01-02", "2025-01-03", "2025-01-04", "2025-01-05", "2025-01-06", "2025-01-07", "2025-01-08", "2025-01-09", "2025-01-10", "2025-01-11", "2025-01-12", "2025-01-13", "2025-01-14", "2025-01-15", "2025-01-16", "2025-01-17", "2025-01-18", "2025-01-19", "2025-01-20", "2025-01-21", "2025-01-22", "2025-01-23", "2025-01-24", "2025-01-25", "2025-01-26", "2025-01-27", "2025-01-28", "2025-01-29", "2025-01-30", "2025-01-31", "2025-02-01", "2025-02-02", "2025-02-03", "2025-02-04", "2025-02-05", "2025-02-06", "2025-02-07", "2025-02-08", "2025-02-09", "2025-02-10", "2025-02-11", "2025-02-12", "2025-02-13", "2025-02-14", "2025-02-15", "2025-02-16", "2025-02-17", "2025-02-18", "2025-02-19", "2025-02-20", "2025-02-21", "2025-02-22", "2025-02-23", "2025-02-24", "2025-02-25", "2025-02-26", "2025-02-27", "2025-02-28", "2025-03-01", "2025-03-02", "2025-03-03", "2025-03-04", "2025-03-05", "2025-03-06", "2025-03-07", "2025-03-08", "2025-03-09", "2025-03-10", "2025-03-11", "2025-03-12", "2025-03-13", "2025-03-14", "2025-03-15", "2025-03-16", "2025-03-17", "2025-03-18", "2025-03-19", "2025-03-20", "2025-03-21", "2025-03-22", "2025-03-23", "2025-03-24", "2025-03-25", "2025-03-26", "2025-03-27", "2025-03-28", "2025-03-29", "2025-03-30", "2025-03-31", "2025-04-01", "2025-04-02", "2025-04-03", "2025-04-04", "2025-04-05", "2025-04-06", "2025-04-07", "2025-04-08", "2025-04-09", "2025-04-10", "2025-04-11", "2025-04-12", "2025-04-13", "2025-04-14", "2025-04-15", "2025-04-16", "2025-04-17", "2025-04-18", "2025-04-19", "2025-04-20", "2025-04-21", "2025-04-22", "2025-04-23", "2025-04-24", "2025-04-25", "2025-04-26", "2025-04-27", "2025-04-28", "2025-04-29", "2025-04-30", "2025-05-01", "2025-05-02", "2025-05-03", "2025-05-04", "2025-05-05", "2025-05-06", "2025-05-07", "2025-05-08", "2025-05-09", "2025-05-10", "2025-05-11", "2025-05-12", "2025-05-13", "2025-05-14", "2025-05-15", "2025-05-16", "2025-05-17", "2025-05-18", "2025-05-19", "2025-05-20", "2025-05-21", "2025-05-22", "2025-05-23", "2025-05-24", "2025-05-25", "2025-05-26", "2025-05-27", "2025-05-28", "2025-05-29", "2025-05-30", "2025-05-31", "2025-06-01", "2025-06-02", "2025-06-03", "2025-06-04", "2025-06-05", "2025-06-06", "2025-06-07", "2025-06-08", "2025-06-09", "2025-06-10", "2025-06-11", "2025-06-12", "2025-06-13", "2025-06-14", "2025-06-15", "2025-06-16", "2025-06-17", "2025-06-18", "2025-06-19", "2025-06-20", "2025-06-21", "2025-06-22", "2025-06-23", "2025-06-24", "2025-06-25", "2025-06-26", "2025-06-27", "2025-06-28", "2025-06-29", "2025-06-30", "2025-07-01", "2025-07-02", "2025-07-03", "2025-07-04", "2025-07-05", "2025-07-06", "2025-07-07", "2025-07-08", "2025-07-09", "2025-07-10", "2025-07-11", "2025-07-12", "2025-07-13", "2025-07-14", "2025-07-15", "2025-07-16", "2025-07-17", "2025-07-18", "2025-07-19", "2025-07-20", "2025-07-21", "2025-07-22", "2025-07-23", "2025-07-24", "2025-07-25", "2025-07-26", "2025-07-27", "2025-07-28", "2025-07-29", "2025-07-30", "2025-07-31", "2025-08-01", "2025-08-02", "2025-08-03", "2025-08-04", "2025-08-05", "2025-08-06", "2025-08-07", "2025-08-08", "2025-08-09", "2025-08-10", "2025-08-11", "2025-08-12", "2025-08-13", "2025-08-14", "2025-08-15", "2025-08-16", "2025-08-17", "2025-08-18", "2025-08-19", "2025-08-20", "2025-08-21", "2025-08-22", "2025-08-23", "2025-08-24", "2025-08-25", "2025-08-26", "2025-08-27", "2025-08-28", "2025-08-29", "2025-08-30", "2025-08-31", "2025-09-01", "2025-09-02", "2025-09-03", "2025-09-04", "2025-09-05", "2025-09-06", "2025-09-07", "2025-09-08", "2025-09-09", "2025-09-10", "2025-09-11", "2025-09-12", "2025-09-13", "2025-09-14", "2025-09-15", "2025-09-16", "2025-09-17", "2025-09-18", "2025-09-19", "2025-09-20", "2025-09-21", "2025-09-22", "2025-09-23", "2025-09-24", "2025-09-25", "2025-09-26", "2025-09-27", "2025-09-28", "2025-09-29", "2025-09-30", "2025-10-01", "2025-10-02", "2025-10-03", "2025-10-04", "2025-10-05", "2025-10-06", "2025-10-07", "2025-10-08", "2025-10-09", "2025-10-10", "2025-10-11", "2025-10-12", "2025-10-13", "2025-10-14", "2025-10-15", "2025-10-16", "2025-10-17", "2025-10-18", "2025-10-19", "2025-10-20", "2025-10-21", "2025-10-22", "2025-10-23", "2025-10-24", "2025-10-25", "2025-10-26", "2025-10-27", "2025-10-28", "2025-10-29", "2025-10-30", "2025-10-31", "2025-11-01", "2025-11-02", "2025-11-03", "2025-11-04", "2025-11-05", "2025-11-06", "2025-11-07", "2025-11-08", "2025-11-09", "2025-11-10", "2025-11-11", "2025-11-12", "2025-11-13", "2025-11-14", "2025-11-15", "2025-11-16", "2025-11-17", "2025-11-18", "2025-11-19", "2025-11-20", "2025-11-21", "2025-11-22", "2025-11-23", "2025-11-24", "2025-11-25", "2025-11-26", "2025-11-27", "2025-11-28", "2025-11-29", "2025-11-30", "2025-12-01", "2025-12-02", "2025-12-03", "2025-12-04", "2025-12-05", "2025-12-06", "2025-12-07", "2025-12-08", "2025-12-09", "2025-12-10", "2025-12-11", "2025-12-12", "2025-12-13", "2025-12-14", "2025-12-15", "2025-12-16", "2025-12-17", "2025-12-18", "2025-12-19", "2025-12-20", "2025-12-21", "2025-12-22", "2025-12-23", "2025-12-24", "2025-12-25", "2025-12-26", "2025-12-27", "2025-12-28", "2025-12-29", "2025-12-30", "2025-12-31"], "max": [22.2, 23.5, 21.0, 21.9, 21.9, 21.9, 22.2, 22.2, 21.0, 15.9, 15.9, 18.7, 21.3, 23.9, 20.1, 19.5, 19.8, 21.5, 23.0, 23.2, 23.1, 24.5, 23.0, 24.5, 24.4, 17.9, 16.6, 19.5, 21.0, 22.0, 24.7, 24.6, 19.4, 14.7, 18.2, 17.6, 19.6, 13.6, 15.4, 16.2, 19.1, 23.4, 26.1, 22.5, 24.4, 23.8, 24.1, 23.3, 21.7, 22.8, 26.2, 20.5, 19.5, 17.1, 19.9, 16.2, 19.3, 22.9, 26.4, 26.9, 29.3, 25.8, 22.5, 15.5, 16.2, 14.9, 18.1, 23.4, 25.0, 26.1, 27.4, 28.0, 27.5, 22.1, 19.0, 19.1, 20.2, 21.9, 23.0, 24.6, 25.5, 27.0, 30.3, 32.6, 32.4, 33.0, 26.0, 13.9, 12.1, 13.3, 20.8, 23.0, 25.6, 25.8, 21.8, 24.5, 27.4, 29.2, 31.2, 31.3, 32.0, 30.8, 21.5, 28.4, 31.5, 30.4, 31.0, 27.5, 29.9, 32.2, 32.1, 34.2, 31.5, 31.3, 23.1, 27.4, 28.0, 30.4, 28.9, 29.5, 27.5, 31.7, 29.9, 29.0, 29.9, 29.5, 28.0, 30.2, 26.9, 30.5, 26.2, 28.5, 29.0, 30.4, 30.9, 30.8, 28.7, 30.6, 30.8, 29.1, 32.0, 32.0, 29.5, 27.2, 24.5, 26.8, 27.1, 29.5, 25.4, 28.2, 29.9, 32.0, 31.5, 26.6, 29.0, 31.4, 32.5, 34.0, 33.7, 34.7, 34.4, 34.3, 32.1, 30.1, 29.6, 29.6, 27.5, 26.6, 29.1, 31.5, 29.9, 29.6, 31.0, 32.7, 33.2, 33.4, 29.5, 31.1, 30.1, 29.9, 30.4, 30.2, 32.1, 32.8, 33.3, 33.9, 34.1, 35.5, 35.3, 36.5, 31.6, 29.8, 31.4, 30.5, 31.5, 30.9, 34.2, 33.0, 33.1, 33.1, 29.2, 30.6, 30.9, 32.0, 33.3, 33.9, 34.7, 34.3, 32.2, 32.5, 33.0, 32.3, 32.3, 30.5, 29.4, 27.5, 28.5, 28.3, 31.2, 33.0, 33.8, 32.8, 33.2, 33.0, 33.5, 27.2, 30.5, 32.9, 31.2, 28.1, 28.1, 31.9, 32.1, 31.1, 34.5, 32.1, 33.3, 33.7, 33.5, 32.7, 35.0, 34.0, 33.4, 36.4, 36.0, 35.6, 37.8, 38.0, 37.3, 34.3, 26.9, 30.8, 31.4, 32.0, 32.3, 32.7, 32.8, 33.5, 33.7, 34.3, 33.0, 32.0, 26.2, 29.0, 32.2, 32.3, 26.0, 29.5, 32.7, 32.5, 30.2, 31.9, 33.0, 33.5, 32.1, 33.0, 34.2, 30.6, 31.7, 34.3, 34.7, 35.3, 35.5, 35.7, 32.4, 29.4, 32.7, 33.0, 33.8, 34.7, 34.7, 32.9, 29.0, 21.9, 17.9, 22.6, 23.9, 27.8, 29.5, 27.4, 25.5, 28.1, 28.5, 29.6, 25.6, 23.7, 20.1, 17.5, 25.8, 28.8, 26.8, 29.8, 29.6, 28.6, 25.5, 24.5, 21.6, 24.9, 26.6, 27.1, 28.0, 20.7, 15.9, 18.0, 20.7, 22.0, 24.1, 25.9, 22.6, 21.7, 21.6, 21.6, 23.2, 21.5, 24.9, 22.6, 21.1, 20.9, 23.0, 22.5, 24.6, 24.0, 23.7, 23.1, 25.7, 23.8, 19.2, 16.6, 19.0, 22.0, 25.5, 23.6, 24.0, 25.8, 24.5, 22.0, 25.2, 25.1, 16.7, 12.2, 18.5, 18.9, 21.0, 22.5, 21.9], "min": [11.1, 11.9, 12.6, 10.6, 12.8, 11.2, 10.1, 10.6, 10.5, 7.6, 7.8, 7.2, 7.6, 15.1, 14.7, 9.9, 8.9, 9.2, 10.4, 10.5, 11.6, 15.1, 15.9, 16.7, 15.0, 9.2, 7.2, 9.4, 10.9, 11.4, 13.9, 16.6, 13.9, 10.4, 7.8, 8.6, 11.7, 9.8, 8.1, 4.5, 8.1, 12.1, 17.2, 12.1, 13.1, 14.1, 16.5, 13.2, 14.9, 15.4, 16.6, 14.2, 14.1, 10.9, 7.9, 12.9, 12.1, 13.9, 14.1, 18.3, 20.4, 19.9, 15.9, 11.2, 9.6, 8.6, 9.6, 13.6, 14.5, 16.7, 17.8, 20.0, 20.4, 14.5, 11.1, 11.1, 13.0, 11.4, 12.1, 12.6, 13.3, 15.1, 16.2, 18.0, 19.1, 20.2, 14.7, 9.1, 8.7, 8.9, 9.9, 10.1, 13.1, 14.7, 17.9, 16.8, 16.4, 17.5, 20.8, 21.8, 22.5, 18.5, 15.9, 14.3, 17.6, 17.4, 19.9, 22.5, 24.4, 24.7, 23.7, 23.6, 24.0, 23.1, 19.6, 19.2, 21.3, 22.3, 20.6, 20.4, 22.9, 22.4, 23.2, 22.9, 23.0, 22.4, 23.0, 23.8, 24.1, 22.5, 16.5, 17.1, 19.5, 22.0, 23.5, 24.2, 24.5, 24.0, 23.5, 24.7, 25.2, 25.3, 25.0, 22.6, 21.2, 19.8, 20.2, 22.9, 22.4, 21.6, 23.0, 23.8, 25.6, 22.8, 23.2, 24.6, 24.2, 25.4, 26.2, 26.5, 26.2, 24.5, 25.0, 24.8, 24.2, 25.2, 24.8, 23.9, 24.6, 25.2, 24.9, 25.2, 25.4, 25.7, 26.0, 25.9, 25.0, 23.7, 24.0, 25.1, 25.4, 24.5, 24.5, 25.4, 26.2, 26.7, 26.2, 27.1, 27.0, 26.8, 26.5, 25.4, 25.0, 25.8, 26.2, 26.2, 27.2, 27.6, 26.5, 25.9, 25.8, 25.1, 25.0, 25.2, 24.4, 25.1, 25.0, 26.8, 26.9, 26.3, 26.0, 24.6, 24.8, 26.3, 25.0, 25.1, 24.5, 23.7, 23.9, 23.4, 25.7, 26.1, 26.2, 25.5, 26.2, 24.5, 23.5, 23.2, 24.4, 24.4, 23.9, 25.1, 25.6, 25.9, 25.8, 25.7, 25.5, 24.5, 25.2, 24.8, 25.5, 25.2, 25.5, 25.9, 26.9, 26.7, 27.1, 27.4, 27.8, 26.2, 24.3, 24.4, 24.6, 24.7, 25.4, 25.5, 25.5, 25.6, 25.6, 23.9, 24.4, 25.5, 24.2, 23.8, 23.8, 25.5, 24.1, 23.8, 24.2, 24.2, 25.2, 24.8, 25.0, 25.1, 25.1, 25.1, 25.6, 24.9, 25.0, 24.9, 26.0, 26.0, 26.6, 25.5, 25.6, 25.5, 24.9, 25.0, 25.8, 25.3, 25.6, 24.7, 21.4, 17.1, 16.1, 15.6, 18.9, 19.0, 21.5, 19.1, 19.9, 20.0, 22.0, 21.6, 19.9, 19.6, 17.5, 17.0, 16.6, 17.6, 22.0, 23.1, 21.9, 19.2, 19.1, 17.4, 18.0, 17.6, 18.0, 20.0, 19.0, 11.5, 10.5, 11.2, 12.5, 12.8, 13.8, 17.1, 14.9, 11.2, 12.8, 11.8, 9.8, 17.1, 16.7, 19.2, 16.5, 14.0, 14.8, 13.6, 14.3, 16.2, 14.0, 15.6, 17.5, 17.6, 12.5, 10.8, 8.1, 12.2, 16.4, 14.0, 15.9, 17.6, 17.1, 14.0, 16.1, 16.1, 11.8, 8.4, 11.3, 11.5, 11.6, 13.2, 13.1], "mean": [16.5, 17.6, 16.6, 16.1, 17.1, 16.2, 16.2, 16.4, 15.5, 11.6, 11.4, 12.6, 14.9, 18.9, 17.9, 14.4, 14.2, 15.1, 16.5, 17.1, 17.4, 19.4, 19.5, 19.7, 19.2, 11.7, 11.6, 13.8, 15.3, 16.3, 19.0, 20.3, 16.6, 12.4, 12.5, 13.1, 15.0, 11.4, 11.0, 10.3, 13.5, 17.5, 20.8, 17.3, 18.7, 19.1, 19.8, 18.4, 17.7, 18.6, 20.5, 17.4, 16.3, 14.0, 13.6, 14.4, 14.9, 17.9, 19.7, 22.0, 23.8, 21.8, 19.0, 13.8, 12.2, 11.1, 13.6, 17.8, 20.0, 21.5, 22.4, 23.5, 23.4, 19.6, 14.7, 14.8, 15.8, 16.1, 17.4, 18.5, 19.5, 20.8, 22.9, 24.6, 24.9, 25.9, 23.4, 12.1, 10.1, 10.6, 14.4, 16.9, 19.5, 20.1, 19.4, 20.4, 21.7, 23.3, 24.8, 26.3, 26.7, 23.8, 18.7, 21.2, 24.2, 23.6, 25.0, 24.6, 26.1, 27.2, 27.2, 27.5, 26.5, 25.6, 21.5, 23.0, 23.5, 25.7, 24.9, 24.9, 24.6, 26.5, 25.5, 25.8, 25.9, 25.4, 24.9, 26.5, 25.3, 25.3, 21.8, 23.0, 24.0, 25.9, 27.0, 26.5, 26.2, 26.0, 25.9, 26.5, 27.3, 27.9, 26.8, 24.9, 22.7, 23.0, 24.0, 24.8, 23.6, 24.4, 26.2, 27.4, 28.1, 24.9, 25.9, 27.3, 28.0, 29.2, 29.6, 30.3, 29.4, 28.1, 27.4, 27.0, 26.3, 26.9, 26.0, 24.8, 26.8, 27.7, 27.1, 27.1, 27.5, 28.7, 29.3, 29.5, 26.8, 26.9, 26.6, 27.2, 27.2, 26.4, 27.6, 28.7, 29.6, 29.4, 29.9, 30.7, 30.0, 30.6, 28.0, 27.1, 27.4, 27.5, 28.1, 28.3, 30.4, 30.5, 29.2, 28.7, 27.6, 26.7, 27.4, 27.1, 27.8, 28.5, 29.5, 30.4, 28.8, 28.8, 28.2, 27.8, 28.1, 27.5, 26.7, 26.0, 25.9, 25.6, 27.3, 28.0, 29.5, 29.1, 28.9, 28.6, 29.2, 26.0, 26.6, 27.6, 26.8, 25.6, 25.8, 27.3, 28.4, 28.4, 29.0, 28.3, 28.1, 28.8, 27.9, 27.7, 29.3, 28.8, 29.4, 30.9, 30.6, 30.1, 31.9, 32.2, 32.4, 29.5, 25.6, 26.6, 27.1, 27.7, 28.7, 28.8, 28.8, 28.7, 28.7, 27.6, 27.9, 27.9, 25.0, 25.2, 27.7, 28.2, 25.0, 25.9, 28.0, 28.2, 27.1, 28.3, 28.8, 28.9, 28.4, 28.8, 28.9, 27.0, 27.6, 29.4, 29.9, 30.2, 30.7, 30.2, 27.6, 27.1, 28.1, 28.7, 29.0, 29.5, 30.1, 28.2, 24.6, 19.8, 17.1, 18.9, 21.4, 23.7, 25.1, 22.9, 22.3, 23.8, 24.1, 24.2, 22.3, 21.6, 18.9, 17.3, 20.8, 22.8, 24.4, 25.9, 25.2, 22.6, 21.2, 20.1, 19.5, 20.4, 22.1, 23.0, 23.2, 14.7, 12.7, 13.8, 15.8, 16.7, 18.5, 20.8, 18.5, 15.9, 16.8, 15.9, 16.4, 18.5, 20.0, 20.5, 19.0, 16.9, 18.7, 18.1, 19.0, 19.3, 18.3, 18.9, 21.2, 20.6, 16.0, 13.1, 13.3, 17.1, 20.0, 18.4, 19.6, 21.2, 20.4, 17.8, 19.9, 20.4, 13.4, 10.7, 13.8, 14.9, 16.3, 17.3, 17.3]}, "chart_2025": {"labels": ["1月", "2月", "3月", "4月", "5月", "6月", "7月", "8月", "9月", "10月", "11月", "12月"], "max": [21.35, 20.66, 23.31, 28.41, 29.04, 31.03, 32.64, 31.69, 32.54, 30.51, 23.8, 22.07], "min": [11.18, 12.31, 14.37, 19.15, 22.55, 24.9, 25.9, 24.99, 25.2, 23.05, 16.35, 14.25], "mean": [15.99, 16.17, 18.63, 23.27, 25.29, 27.5, 28.6, 27.75, 28.3, 26.33, 19.54, 17.79]}, "chart_10y": {"labels": ["2016", "2017", "2018", "2019", "2020", "2021", "2022", "2023", "2024", "2025"], "max": [26.13, 26.02, 26.08, 27.13, 27.1, 27.29, 26.31, 26.8, 26.87, 27.29], "min": [19.7, 19.44, 19.14, 19.86, 19.71, 19.87, 19.03, 19.64, 19.82, 19.55], "mean": [22.52, 22.39, 22.29, 23.15, 23.02, 23.23, 22.3, 22.86, 22.93, 22.97]}, "chart_ab": {"labels": ["2016", "2017", "2018", "2019", "2020", "2021", "2022", "2023", "2024", "2025"], "high": [21, 6, 3, 9, 32, 20, 23, 20, 15, 38], "low": [20, 14, 33, 6, 19, 16, 26, 25, 18, 12]}, "chart_2026": {"labels": ["1月", "2月", "3月", "4月", "5月", "6月", "7月", "8月", "9月", "10月", "11月", "12月"], "mean": [15.3, 16.1, 19.8, 23.1, 26.0, 27.8, 29.0, 28.2, 27.7, 24.6, 20.7, 15.8], "max": [19.7, 20.7, 24.0, 27.2, 29.6, 31.1, 32.5, 31.6, 31.3, 28.5, 24.8, 20.3], "min": [11.5, 12.3, 16.2, 19.8, 23.2, 25.4, 26.2, 25.7, 24.9, 21.3, 17.3, 12.0]}, "chart_2026_daily": {"labels": ["2026-01-01", "2026-01-02", "2026-01-03", "2026-01-04", "2026-01-05", "2026-01-06", "2026-01-07", "2026-01-08", "2026-01-09", "2026-01-10", "2026-01-11", "2026-01-12", "2026-01-13", "2026-01-14", "2026-01-15", "2026-01-16", "2026-01-17", "2026-01-18", "2026-01-19", "2026-01-20", "2026-01-21", "2026-01-22", "2026-01-23", "2026-01-24", "2026-01-25", "2026-01-26", "2026-01-27", "2026-01-28", "2026-01-29", "2026-01-30", "2026-01-31", "2026-02-01", "2026-02-02", "2026-02-03", "2026-02-04", "2026-02-05", "2026-02-06", "2026-02-07", "2026-02-08", "2026-02-09", "2026-02-10", "2026-02-11", "2026-02-12", "2026-02-13", "2026-02-14", "2026-02-15", "2026-02-16", "2026-02-17", "2026-02-18", "2026-02-19", "2026-02-20", "2026-02-21", "2026-02-22", "2026-02-23", "2026-02-24", "2026-02-25", "2026-02-26", "2026-02-27", "2026-02-28", "2026-03-01", "2026-03-02", "2026-03-03", "2026-03-04", "2026-03-05", "2026-03-06", "2026-03-07", "2026-03-08", "2026-03-09", "2026-03-10", "2026-03-11", "2026-03-12", "2026-03-13", "2026-03-14", "2026-03-15", "2026-03-16", "2026-03-17", "2026-03-18", "2026-03-19", "2026-03-20", "2026-03-21", "2026-03-22", "2026-03-23", "2026-03-24", "2026-03-25", "2026-03-26", "2026-03-27", "2026-03-28", "2026-03-29", "2026-03-30", "2026-03-31", "2026-04-01", "2026-04-02", "2026-04-03", "2026-04-04", "2026-04-05", "2026-04-06", "2026-04-07", "2026-04-08", "2026-04-09", "2026-04-10", "2026-04-11", "2026-04-12", "2026-04-13", "2026-04-14", "2026-04-15", "2026-04-16", "2026-04-17", "2026-04-18", "2026-04-19", "2026-04-20", "2026-04-21", "2026-04-22", "2026-04-23", "2026-04-24", "2026-04-25", "2026-04-26", "2026-04-27", "2026-04-28", "2026-04-29", "2026-04-30", "2026-05-01", "2026-05-02", "2026-05-03", "2026-05-04", "2026-05-05", "2026-05-06", "2026-05-07", "2026-05-08", "2026-05-09", "2026-05-10", "2026-05-11", "2026-05-12", "2026-05-13", "2026-05-14", "2026-05-15", "2026-05-16", "2026-05-17", "2026-05-18", "2026-05-19", "2026-05-20", "2026-05-21", "2026-05-22", "2026-05-23", "2026-05-24", "2026-05-25", "2026-05-26", "2026-05-27", "2026-05-28", "2026-05-29", "2026-05-30", "2026-05-31", "2026-06-01", "2026-06-02", "2026-06-03", "2026-06-04", "2026-06-05", "2026-06-06", "2026-06-07", "2026-06-08", "2026-06-09", "2026-06-10", "2026-06-11", "2026-06-12", "2026-06-13", "2026-06-14", "2026-06-15", "2026-06-16", "2026-06-17", "2026-06-18", "2026-06-19", "2026-06-20", "2026-06-21", "2026-06-22", "2026-06-23", "2026-06-24", "2026-06-25", "2026-06-26", "2026-06-27", "2026-06-28", "2026-06-29", "2026-06-30", "2026-07-01", "2026-07-02", "2026-07-03", "2026-07-04", "2026-07-05", "2026-07-06", "2026-07-07", "2026-07-08", "2026-07-09", "2026-07-10", "2026-07-11", "2026-07-12", "2026-07-13", "2026-07-14", "2026-07-15", "2026-07-16", "2026-07-17", "2026-07-18", "2026-07-19", "2026-07-20", "2026-07-21", "2026-07-22", "2026-07-23", "2026-07-24", "2026-07-25", "2026-07-26", "2026-07-27", "2026-07-28", "2026-07-29", "2026-07-30", "2026-07-31", "2026-08-01", "2026-08-02", "2026-08-03", "2026-08-04", "2026-08-05", "2026-08-06", "2026-08-07", "2026-08-08", "2026-08-09", "2026-08-10", "2026-08-11", "2026-08-12", "2026-08-13", "2026-08-14", "2026-08-15", "2026-08-16", "2026-08-17", "2026-08-18", "2026-08-19", "2026-08-20", "2026-08-21", "2026-08-22", "2026-08-23", "2026-08-24", "2026-08-25", "2026-08-26", "2026-08-27", "2026-08-28", "2026-08-29", "2026-08-30", "2026-08-31", "2026-09-01", "2026-09-02", "2026-09-03", "2026-09-04", "2026-09-05", "2026-09-06", "2026-09-07", "2026-09-08", "2026-09-09", "2026-09-10", "2026-09-11", "2026-09-12", "2026-09-13", "2026-09-14", "2026-09-15", "2026-09-16", "2026-09-17", "2026-09-18", "2026-09-19", "2026-09-20", "2026-09-21", "2026-09-22", "2026-09-23", "2026-09-24", "2026-09-25", "2026-09-26", "2026-09-27", "2026-09-28", "2026-09-29", "2026-09-30", "2026-10-01", "2026-10-02", "2026-10-03", "2026-10-04", "2026-10-05", "2026-10-06", "2026-10-07", "2026-10-08", "2026-10-09", "2026-10-10", "2026-10-11", "2026-10-12", "2026-10-13", "2026-10-14", "2026-10-15", "2026-10-16", "2026-10-17", "2026-10-18", "2026-10-19", "2026-10-20", "2026-10-21", "2026-10-22", "2026-10-23", "2026-10-24", "2026-10-25", "2026-10-26", "2026-10-27", "2026-10-28", "2026-10-29", "2026-10-30", "2026-10-31", "2026-11-01", "2026-11-02", "2026-11-03", "2026-11-04", "2026-11-05", "2026-11-06", "2026-11-07", "2026-11-08", "2026-11-09", "2026-11-10", "2026-11-11", "2026-11-12", "2026-11-13", "2026-11-14", "2026-11-15", "2026-11-16", "2026-11-17", "2026-11-18", "2026-11-19", "2026-11-20", "2026-11-21", "2026-11-22", "2026-11-23", "2026-11-24", "2026-11-25", "2026-11-26", "2026-11-27", "2026-11-28", "2026-11-29", "2026-11-30", "2026-12-01", "2026-12-02", "2026-12-03", "2026-12-04", "2026-12-05", "2026-12-06", "2026-12-07", "2026-12-08", "2026-12-09", "2026-12-10", "2026-12-11", "2026-12-12", "2026-12-13", "2026-12-14", "2026-12-15", "2026-12-16", "2026-12-17", "2026-12-18", "2026-12-19", "2026-12-20", "2026-12-21", "2026-12-22", "2026-12-23", "2026-12-24", "2026-12-25", "2026-12-26", "2026-12-27", "2026-12-28", "2026-12-29", "2026-12-30", "2026-12-31"], "max": [19.7, 19.9, 20.2, 20.4, 20.6, 20.7, 20.8, 20.9, 20.9, 20.9, 20.8, 20.6, 20.5, 20.3, 20.1, 19.8, 19.6, 19.3, 19.1, 18.9, 18.8, 18.6, 18.5, 18.5, 18.5, 18.6, 18.7, 18.8, 19.0, 19.2, 19.5, 20.7, 21.0, 21.2, 21.4, 21.6, 21.8, 21.9, 21.9, 21.9, 21.8, 21.6, 21.4, 21.2, 21.0, 20.7, 20.4, 20.2, 20.0, 19.8, 19.6, 19.5, 19.5, 19.5, 19.6, 19.8, 20.0, 20.2, 20.4, 24.0, 24.2, 24.5, 24.7, 24.9, 25.0, 25.1, 25.2, 25.2, 25.2, 25.1, 24.9, 24.8, 24.6, 24.4, 24.1, 23.9, 23.6, 23.4, 23.2, 23.1, 22.9, 22.8, 22.8, 22.8, 22.9, 23.0, 23.1, 23.3, 23.5, 23.8, 27.2, 27.4, 27.7, 27.9, 28.1, 28.2, 28.3, 28.4, 28.4, 28.3, 28.2, 28.1, 27.9, 27.7, 27.4, 27.2, 27.0, 26.7, 26.5, 26.3, 26.2, 26.1, 26.0, 26.0, 26.1, 26.2, 26.3, 26.5, 26.7, 27.0, 29.6, 29.8, 30.1, 30.3, 30.5, 30.6, 30.7, 30.8, 30.8, 30.8, 30.7, 30.5, 30.4, 30.2, 30.0, 29.7, 29.5, 29.2, 29.0, 28.8, 28.7, 28.5, 28.4, 28.4, 28.4, 28.5, 28.6, 28.7, 28.9, 29.1, 29.4, 31.1, 31.3, 31.6, 31.8, 32.0, 32.1, 32.2, 32.3, 32.3, 32.2, 32.1, 32.0, 31.8, 31.6, 31.3, 31.1, 30.9, 30.6, 30.4, 30.2, 30.1, 30.0, 29.9, 29.9, 30.0, 30.1, 30.2, 30.4, 30.6, 30.9, 32.5, 32.7, 33.0, 33.2, 33.4, 33.5, 33.6, 33.7, 33.7, 33.7, 33.6, 33.4, 33.3, 33.1, 32.9, 32.6, 32.4, 32.1, 31.9, 31.7, 31.6, 31.4, 31.3, 31.3, 31.3, 31.4, 31.5, 31.6, 31.8, 32.0, 32.3, 31.6, 31.8, 32.1, 32.3, 32.5, 32.6, 32.7, 32.8, 32.8, 32.8, 32.7, 32.5, 32.4, 32.2, 32.0, 31.7, 31.5, 31.2, 31.0, 30.8, 30.7, 30.5, 30.4, 30.4, 30.4, 30.5, 30.6, 30.7, 30.9, 31.1, 31.4, 31.3, 31.5, 31.8, 32.0, 32.2, 32.3, 32.4, 32.5, 32.5, 32.4, 32.3, 32.2, 32.0, 31.8, 31.5, 31.3, 31.1, 30.8, 30.6, 30.4, 30.3, 30.2, 30.1, 30.1, 30.2, 30.3, 30.4, 30.6, 30.8, 31.1, 28.5, 28.7, 29.0, 29.2, 29.4, 29.5, 29.6, 29.7, 29.7, 29.7, 29.6, 29.4, 29.3, 29.1, 28.9, 28.6, 28.4, 28.1, 27.9, 27.7, 27.6, 27.4, 27.3, 27.3, 27.3, 27.4, 27.5, 27.6, 27.8, 28.0, 28.3, 24.8, 25.0, 25.3, 25.5, 25.7, 25.8, 25.9, 26.0, 26.0, 25.9, 25.8, 25.7, 25.5, 25.3, 25.0, 24.8, 24.6, 24.3, 24.1, 23.9, 23.8, 23.7, 23.6, 23.6, 23.7, 23.8, 23.9, 24.1, 24.3, 24.6, 20.3, 20.5, 20.8, 21.0, 21.2, 21.3, 21.4, 21.5, 21.5, 21.5, 21.4, 21.2, 21.1, 20.9, 20.7, 20.4, 20.2, 19.9, 19.7, 19.5, 19.4, 19.2, 19.1, 19.1, 19.1, 19.2, 19.3, 19.4, 19.6, 19.8, 20.1], "min": [11.5, 11.7, 12.0, 12.2, 12.4, 12.5, 12.6, 12.7, 12.7, 12.7, 12.6, 12.4, 12.3, 12.1, 11.9, 11.6, 11.4, 11.1, 10.9, 10.7, 10.6, 10.4, 10.3, 10.3, 10.3, 10.4, 10.5, 10.6, 10.8, 11.0, 11.3, 12.3, 12.6, 12.8, 13.0, 13.2, 13.4, 13.5, 13.5, 13.5, 13.4, 13.2, 13.0, 12.8, 12.6, 12.3, 12.0, 11.8, 11.6, 11.4, 11.2, 11.1, 11.1, 11.1, 11.2, 11.4, 11.6, 11.8, 12.0, 16.2, 16.4, 16.7, 16.9, 17.1, 17.2, 17.3, 17.4, 17.4, 17.4, 17.3, 17.1, 17.0, 16.8, 16.6, 16.3, 16.1, 15.8, 15.6, 15.4, 15.3, 15.1, 15.0, 15.0, 15.0, 15.1, 15.2, 15.3, 15.5, 15.7, 16.0, 19.8, 20.0, 20.3, 20.5, 20.7, 20.8, 20.9, 21.0, 21.0, 20.9, 20.8, 20.7, 20.5, 20.3, 20.0, 19.8, 19.6, 19.3, 19.1, 18.9, 18.8, 18.7, 18.6, 18.6, 18.7, 18.8, 18.9, 19.1, 19.3, 19.6, 23.2, 23.4, 23.7, 23.9, 24.1, 24.2, 24.3, 24.4, 24.4, 24.4, 24.3, 24.1, 24.0, 23.8, 23.6, 23.3, 23.1, 22.8, 22.6, 22.4, 22.3, 22.1, 22.0, 22.0, 22.0, 22.1, 22.2, 22.3, 22.5, 22.7, 23.0, 25.4, 25.6, 25.9, 26.1, 26.3, 26.4, 26.5, 26.6, 26.6, 26.5, 26.4, 26.3, 26.1, 25.9, 25.6, 25.4, 25.2, 24.9, 24.7, 24.5, 24.4, 24.3, 24.2, 24.2, 24.3, 24.4, 24.5, 24.7, 24.9, 25.2, 26.2, 26.4, 26.7, 26.9, 27.1, 27.2, 27.3, 27.4, 27.4, 27.4, 27.3, 27.1, 27.0, 26.8, 26.6, 26.3, 26.1, 25.8, 25.6, 25.4, 25.3, 25.1, 25.0, 25.0, 25.0, 25.1, 25.2, 25.3, 25.5, 25.7, 26.0, 25.7, 25.9, 26.2, 26.4, 26.6, 26.7, 26.8, 26.9, 26.9, 26.9, 26.8, 26.6, 26.5, 26.3, 26.1, 25.8, 25.6, 25.3, 25.1, 24.9, 24.8, 24.6, 24.5, 24.5, 24.5, 24.6, 24.7, 24.8, 25.0, 25.2, 25.5, 24.9, 25.1, 25.4, 25.6, 25.8, 25.9, 26.0, 26.1, 26.1, 26.0, 25.9, 25.8, 25.6, 25.4, 25.1, 24.9, 24.7, 24.4, 24.2, 24.0, 23.9, 23.8, 23.7, 23.7, 23.8, 23.9, 24.0, 24.2, 24.4, 24.7, 21.3, 21.5, 21.8, 22.0, 22.2, 22.3, 22.4, 22.5, 22.5, 22.5, 22.4, 22.2, 22.1, 21.9, 21.7, 21.4, 21.2, 20.9, 20.7, 20.5, 20.4, 20.2, 20.1, 20.1, 20.1, 20.2, 20.3, 20.4, 20.6, 20.8, 21.1, 17.3, 17.5, 17.8, 18.0, 18.2, 18.3, 18.4, 18.5, 18.5, 18.4, 18.3, 18.2, 18.0, 17.8, 17.5, 17.3, 17.1, 16.8, 16.6, 16.4, 16.3, 16.2, 16.1, 16.1, 16.2, 16.3, 16.4, 16.6, 16.8, 17.1, 12.0, 12.2, 12.5, 12.7, 12.9, 13.0, 13.1, 13.2, 13.2, 13.2, 13.1, 12.9, 12.8, 12.6, 12.4, 12.1, 11.9, 11.6, 11.4, 11.2, 11.1, 10.9, 10.8, 10.8, 10.8, 10.9, 11.0, 11.1, 11.3, 11.5, 11.8], "mean": [15.3, 15.6, 15.9, 16.2, 16.4, 16.6, 16.7, 16.8, 16.8, 16.8, 16.6, 16.5, 16.3, 16.0, 15.7, 15.5, 15.1, 14.9, 14.6, 14.3, 14.1, 14.0, 13.8, 13.8, 13.8, 13.9, 14.0, 14.2, 14.4, 14.7, 15.0, 16.1, 16.4, 16.8, 17.0, 17.3, 17.5, 17.6, 17.6, 17.6, 17.5, 17.3, 17.0, 16.8, 16.4, 16.1, 15.8, 15.4, 15.2, 14.9, 14.7, 14.6, 14.6, 14.6, 14.7, 14.9, 15.2, 15.4, 15.8, 19.8, 20.1, 20.4, 20.7, 20.9, 21.1, 21.2, 21.3, 21.3, 21.3, 21.1, 21.0, 20.8, 20.5, 20.2, 20.0, 19.6, 19.4, 19.1, 18.8, 18.6, 18.5, 18.3, 18.3, 18.3, 18.4, 18.5, 18.7, 18.9, 19.2, 19.5, 23.1, 23.4, 23.7, 24.0, 24.2, 24.4, 24.5, 24.6, 24.6, 24.5, 24.4, 24.2, 24.0, 23.7, 23.4, 23.1, 22.8, 22.5, 22.2, 22.0, 21.8, 21.7, 21.6, 21.6, 21.7, 21.8, 22.0, 22.2, 22.5, 22.8, 26.0, 26.3, 26.6, 26.9, 27.1, 27.3, 27.4, 27.5, 27.5, 27.5, 27.3, 27.2, 27.0, 26.7, 26.4, 26.2, 25.8, 25.6, 25.3, 25.0, 24.8, 24.7, 24.5, 24.5, 24.5, 24.6, 24.7, 24.9, 25.1, 25.4, 25.7, 27.8, 28.1, 28.4, 28.7, 28.9, 29.1, 29.2, 29.3, 29.3, 29.2, 29.1, 28.9, 28.7, 28.4, 28.1, 27.8, 27.5, 27.2, 26.9, 26.7, 26.5, 26.4, 26.3, 26.3, 26.4, 26.5, 26.7, 26.9, 27.2, 27.5, 29.0, 29.3, 29.6, 29.9, 30.1, 30.3, 30.4, 30.5, 30.5, 30.5, 30.3, 30.2, 30.0, 29.7, 29.4, 29.2, 28.8, 28.6, 28.3, 28.0, 27.8, 27.7, 27.5, 27.5, 27.5, 27.6, 27.7, 27.9, 28.1, 28.4, 28.7, 28.2, 28.5, 28.8, 29.1, 29.3, 29.5, 29.6, 29.7, 29.7, 29.7, 29.5, 29.4, 29.2, 28.9, 28.6, 28.4, 28.0, 27.8, 27.5, 27.2, 27.0, 26.9, 26.7, 26.7, 26.7, 26.8, 26.9, 27.1, 27.3, 27.6, 27.9, 27.7, 28.0, 28.3, 28.6, 28.8, 29.0, 29.1, 29.2, 29.2, 29.1, 29.0, 28.8, 28.6, 28.3, 28.0, 27.7, 27.4, 27.1, 26.8, 26.6, 26.4, 26.3, 26.2, 26.2, 26.3, 26.4, 26.6, 26.8, 27.1, 27.4, 24.6, 24.9, 25.2, 25.5, 25.7, 25.9, 26.0, 26.1, 26.1, 26.1, 25.9, 25.8, 25.6, 25.3, 25.0, 24.8, 24.4, 24.2, 23.9, 23.6, 23.4, 23.3, 23.1, 23.1, 23.1, 23.2, 23.3, 23.5, 23.7, 24.0, 24.3, 20.7, 21.0, 21.3, 21.6, 21.8, 22.0, 22.1, 22.2, 22.2, 22.1, 22.0, 21.8, 21.6, 21.3, 21.0, 20.7, 20.4, 20.1, 19.8, 19.6, 19.4, 19.3, 19.2, 19.2, 19.3, 19.4, 19.6, 19.8, 20.1, 20.4, 15.8, 16.1, 16.4, 16.7, 16.9, 17.1, 17.2, 17.3, 17.3, 17.3, 17.1, 17.0, 16.8, 16.5, 16.2, 16.0, 15.6, 15.4, 15.1, 14.8, 14.6, 14.5, 14.3, 14.3, 14.3, 14.4, 14.5, 14.7, 14.9, 15.2, 15.5]}, "chart_forecast": {"labels": ["2026-02-19", "2026-02-20", "2026-02-21", "2026-02-22", "2026-02-23", "2026-02-24", "2026-02-25", "2026-02-26", "2026-02-27", "2026-02-28", "2026-03-01", "2026-03-02", "2026-03-03", "2026-03-04", "2026-03-05", "2026-03-06"], "max": [22.9, 23.9, 25.9, 26.9, 24.1, 27.9, 26.4, 23.4, 26.6, 27.7, 23.4, 14.8, 12.6, 8.3, 8.4, 13.1], "min": [14.0, 16.2, 17.5, 19.4, 19.5, 19.5, 20.3, 19.4, 21.7, 21.3, 13.2, 11.8, 8.7, 6.7, 6.2, 8.1], "mean": [18.3, 19.7, 21.3, 22.6, 21.6, 23.1, 22.9, 21.3, 23.6, 24.1, 18.1, 12.8, 10.8, 7.2, 7.3, 10.5]}};
  var deg = "\u00b0C";

  var btn = document.getElementById("btn-download-report");
  if (btn) {
    btn.addEventListener("click", function() {
      try {
        var d = data;
        var filename = (btn.getAttribute("data-filename-xlsx") || "广州天气报告_表格数据.xlsx").replace(/[/\\:*?"<>|]/g, "_");
        if (typeof XLSX !== "undefined") {
          var wb = XLSX.utils.book_new();
          if (d.chart_forecast && d.chart_forecast.labels && d.chart_forecast.labels.length) {
            var arr = [["日期", "预报最高温(&#176;C)", "预报平均温(&#176;C)", "预报最低温(&#176;C)"]];
            for (var i = 0; i < d.chart_forecast.labels.length; i++)
              arr.push([d.chart_forecast.labels[i], d.chart_forecast.max[i], d.chart_forecast.mean[i], d.chart_forecast.min[i]]);
            wb.SheetNames.push("未来15天"); wb.Sheets["未来15天"] = XLSX.utils.aoa_to_sheet(arr);
          }
          if (d.chart_2025_daily && d.chart_2025_daily.labels && d.chart_2025_daily.labels.length) {
            var arr = [["日期", "日最高温(&#176;C)", "日平均温(&#176;C)", "日最低温(&#176;C)"]];
            for (var i = 0; i < d.chart_2025_daily.labels.length; i++)
              arr.push([d.chart_2025_daily.labels[i], d.chart_2025_daily.max[i], d.chart_2025_daily.mean[i], d.chart_2025_daily.min[i]]);
            wb.SheetNames.push("2025逐日"); wb.Sheets["2025逐日"] = XLSX.utils.aoa_to_sheet(arr);
          }
          if (d.chart_2025 && d.chart_2025.labels && d.chart_2025.labels.length) {
            var arr = [["月份", "月均最高温(&#176;C)", "月均平均温(&#176;C)", "月均最低温(&#176;C)"]];
            for (var i = 0; i < d.chart_2025.labels.length; i++)
              arr.push([d.chart_2025.labels[i], d.chart_2025.max[i], d.chart_2025.mean[i], d.chart_2025.min[i]]);
            wb.SheetNames.push("2025月度"); wb.Sheets["2025月度"] = XLSX.utils.aoa_to_sheet(arr);
          }
          if (d.chart_10y && d.chart_10y.labels && d.chart_10y.labels.length) {
            var arr = [["年份", "年均最高温(&#176;C)", "年均平均温(&#176;C)", "年均最低温(&#176;C)"]];
            for (var i = 0; i < d.chart_10y.labels.length; i++)
              arr.push([d.chart_10y.labels[i], d.chart_10y.max[i], d.chart_10y.mean[i], d.chart_10y.min[i]]);
            wb.SheetNames.push("近10年"); wb.Sheets["近10年"] = XLSX.utils.aoa_to_sheet(arr);
          }
          if (d.chart_ab && d.chart_ab.labels && d.chart_ab.labels.length) {
            var arr = [["年份", "高温异常(天)", "低温异常(天)"]];
            for (var i = 0; i < d.chart_ab.labels.length; i++)
              arr.push([d.chart_ab.labels[i], d.chart_ab.high[i], d.chart_ab.low[i]]);
            wb.SheetNames.push("异常天气"); wb.Sheets["异常天气"] = XLSX.utils.aoa_to_sheet(arr);
          }
          if (d.chart_2026 && d.chart_2026.labels && d.chart_2026.labels.length) {
            var arr = [["月份", "预测最高温(&#176;C)", "预测平均温(&#176;C)", "预测最低温(&#176;C)"]];
            for (var i = 0; i < d.chart_2026.labels.length; i++)
              arr.push([d.chart_2026.labels[i], d.chart_2026.max[i], d.chart_2026.mean[i], d.chart_2026.min[i]]);
            wb.SheetNames.push("2026预测"); wb.Sheets["2026预测"] = XLSX.utils.aoa_to_sheet(arr);
          }
          XLSX.writeFile(wb, filename);
        } else {
          var parts = [];
          function escapeHtml(s) { return String(s).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;"); }
          function tableSection(title, headers, rows) {
            var h = "<tr>" + headers.map(function(th) { return "<th>" + escapeHtml(th) + "</th>"; }).join("") + "</tr>";
            var b = rows.map(function(row) { return "<tr>" + row.map(function(cell) { return "<td>" + escapeHtml(cell) + "</td>"; }).join("") + "</tr>"; }).join("");
            return "<section class=\"data-section\"><h2>" + escapeHtml(title) + "</h2><table><thead>" + h + "</thead><tbody>" + b + "</tbody></table></section>";
          }
          if (d.chart_forecast && d.chart_forecast.labels && d.chart_forecast.labels.length) {
            var rows = d.chart_forecast.labels.map(function(_, i) { return [d.chart_forecast.labels[i], d.chart_forecast.max[i], d.chart_forecast.mean[i], d.chart_forecast.min[i]]; });
            parts.push(tableSection("一、未来 15 天预报", ["日期", "预报最高温（&#176;C）", "预报平均温（&#176;C）", "预报最低温（&#176;C）"], rows));
          }
          if (d.chart_2025_daily && d.chart_2025_daily.labels && d.chart_2025_daily.labels.length) {
            var rows = d.chart_2025_daily.labels.map(function(_, i) { return [d.chart_2025_daily.labels[i], d.chart_2025_daily.max[i], d.chart_2025_daily.mean[i], d.chart_2025_daily.min[i]]; });
            parts.push(tableSection("二、2025 年逐日气温", ["日期", "日最高温（&#176;C）", "日平均温（&#176;C）", "日最低温（&#176;C）"], rows));
          }
          if (d.chart_2025 && d.chart_2025.labels && d.chart_2025.labels.length) {
            var rows = d.chart_2025.labels.map(function(_, i) { return [d.chart_2025.labels[i], d.chart_2025.max[i], d.chart_2025.mean[i], d.chart_2025.min[i]]; });
            parts.push(tableSection("三、2025 年月度气温", ["月份", "月均最高温（&#176;C）", "月均平均温（&#176;C）", "月均最低温（&#176;C）"], rows));
          }
          if (d.chart_10y && d.chart_10y.labels && d.chart_10y.labels.length) {
            var rows = d.chart_10y.labels.map(function(_, i) { return [d.chart_10y.labels[i], d.chart_10y.max[i], d.chart_10y.mean[i], d.chart_10y.min[i]]; });
            parts.push(tableSection("四、近 10 年气温趋势（2016－2025）", ["年份", "年均最高温（&#176;C）", "年均平均温（&#176;C）", "年均最低温（&#176;C）"], rows));
          }
          if (d.chart_ab && d.chart_ab.labels && d.chart_ab.labels.length) {
            var rows = d.chart_ab.labels.map(function(_, i) { return [d.chart_ab.labels[i], d.chart_ab.high[i], d.chart_ab.low[i]]; });
            parts.push(tableSection("五、异常天气（高温/低温异常天数）", ["年份", "高温异常（天）", "低温异常（天）"], rows));
          }
          if (d.chart_2026 && d.chart_2026.labels && d.chart_2026.labels.length) {
            var rows = d.chart_2026.labels.map(function(_, i) { return [d.chart_2026.labels[i], d.chart_2026.max[i], d.chart_2026.mean[i], d.chart_2026.min[i]]; });
            parts.push(tableSection("六、2026 年预测（月均温）", ["月份", "预测最高温（&#176;C）", "预测平均温（&#176;C）", "预测最低温（&#176;C）"], rows));
          }
          var tablePage = "<!DOCTYPE html><html lang=\"zh-CN\"><head><meta charset=\"UTF-8\"><title>广州天气报告 - 表格数据</title><style>" +
            "body { margin:0; font-family: -apple-system, BlinkMacSystemFont, 'PingFang SC', 'Microsoft YaHei', sans-serif; background: #0f1419; color: #e6edf3; padding: 2rem; } " +
            ".container { max-width: 960px; margin: 0 auto; } " +
            "h1 { font-size: 1.5rem; margin-bottom: 0.5rem; } " +
            ".meta { color: #8b949e; font-size: 0.9rem; margin-bottom: 2rem; } " +
            ".data-section { margin-bottom: 2rem; } " +
            ".data-section h2 { font-size: 1.1rem; color: #58a6ff; margin-bottom: 0.75rem; } " +
            "table { width: 100%; border-collapse: collapse; background: #1a2332; border-radius: 8px; overflow: hidden; } " +
            "th, td { padding: 0.5rem 0.75rem; text-align: left; border-bottom: 1px solid #30363d; } " +
            "th { background: rgba(48,54,61,0.5); color: #8b949e; font-weight: 600; font-size: 0.85rem; } " +
            "td { font-size: 0.9rem; } " +
            "tr:hover td { background: rgba(88,166,255,0.08); }</style></head><body><div class=\"container\">" +
            "<h1>广州天气报告 · 表格数据</h1><p class=\"meta\">数据与报告图表一一对应，可复制到 Excel 使用。</p>" +
            parts.join("") +
            "</div></body></html>";
          var blob = new Blob(["﻿" + tablePage], { type: "text/html;charset=utf-8" });
          var url = URL.createObjectURL(blob);
          var a = document.createElement("a");
          a.href = url;
          a.download = filename.replace(/\.xlsx$/i, ".html");
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
        }
      } catch (e) { if (typeof console !== "undefined") console.error(e); alert("下载失败，请稍后重试或复制页面下方表格数据。"); }
    });
  }

  // Visualization-expert: Clarity, Honesty, Simplicity, Accessibility (colorblind-friendly palette)
  var palette = { high: "#e65c2b", mean: "#0173b2", low: "#029e73" };
  var paletteRgba = { high: "rgba(230,92,43,0.15)", mean: "rgba(1,115,178,0.15)", low: "rgba(2,158,115,0.15)" };
  var gridColor = "rgba(48,54,61,0.4)";
  var tickColor = "#8b949e";

  var opts = {
    responsive: true,
    maintainAspectRatio: false,
    color: tickColor,
    font: { family: "'PingFang SC', 'Microsoft YaHei', sans-serif", size: 12 },
    plugins: {
      legend: { position: "top", labels: { usePointStyle: true, padding: 12, boxWidth: 12 } },
      tooltip: {
        backgroundColor: "#1a2332",
        titleColor: "#e6edf3",
        bodyColor: "#e6edf3",
        borderColor: "#30363d",
        borderWidth: 1,
        padding: 10,
        callbacks: {
          label: function(ctx) {
            var name = ctx.dataset.label;
            var v = ctx.parsed.y;
            if (ctx.chart.config.type === "bar") return name + "：" + v + " 天";
            return name + "：" + Number(v).toFixed(1) + deg;
          }
        }
      }
    },
    scales: {
      x: { grid: { display: false }, ticks: { maxRotation: 45, color: tickColor, font: { size: 11 } } },
      y: {
        grid: { color: gridColor, drawBorder: false },
        ticks: { color: tickColor, font: { size: 11 }, stepSize: 5 },
        title: { display: true, text: "温度 (" + deg + ")", color: tickColor, font: { size: 11 } }
      }
    }
  };

  function lineDatasets(labels, max, mean, min, pointRadius) {
    pointRadius = pointRadius ?? 5;
    return [
      { label: labels[0], data: max, borderColor: palette.high, backgroundColor: paletteRgba.high, borderWidth: 2, tension: 0.25, pointRadius: pointRadius, pointHoverRadius: 7 },
      { label: labels[1], data: mean, borderColor: palette.mean, backgroundColor: paletteRgba.mean, borderWidth: 2, tension: 0.25, pointRadius: pointRadius, pointHoverRadius: 7 },
      { label: labels[2], data: min, borderColor: palette.low, backgroundColor: paletteRgba.low, borderWidth: 2, tension: 0.25, pointRadius: pointRadius, pointHoverRadius: 7 }
    ];
  }

  function renderLineChart(canvasId, chartData, optsOverride) {
    if (!chartData || !chartData.labels || chartData.labels.length === 0) return;
    var el = document.getElementById(canvasId);
    if (!el) return;
    var o = Object.assign({}, opts, optsOverride || {});
    new Chart(el, { type: "line", data: { labels: chartData.labels, datasets: lineDatasets(["最高温", "平均温", "最低温"], chartData.max, chartData.mean, chartData.min, 3) }, options: o });
  }

  // 未来 15 天：打开页面时按当前日期请求并绘制
  (function loadForecast15() {
    var forecastUrl = "https://api.open-meteo.com/v1/forecast?latitude=23.1291&longitude=113.2644&daily=temperature_2m_max,temperature_2m_min,temperature_2m_mean&timezone=Asia/Shanghai&forecast_days=16";
    fetch(forecastUrl).then(function(r) { return r.json(); })
      .then(function(fc) {
        var cFc = { labels: [], max: [], min: [], mean: [] };
        if (fc.daily && fc.daily.time) {
          for (var j = 0; j < fc.daily.time.length; j++) {
            cFc.labels.push(fc.daily.time[j]);
            cFc.max.push(fc.daily.temperature_2m_max[j]);
            cFc.min.push(fc.daily.temperature_2m_min[j]);
            cFc.mean.push(fc.daily.temperature_2m_mean[j]);
          };
        };
        data.chart_forecast = cFc;
        var loadingFc = document.getElementById("forecast-loading");
        var wrapFc = document.getElementById("wrap-forecast");
        if (cFc.labels.length) {
          if (loadingFc) loadingFc.style.display = "none";
          if (wrapFc) wrapFc.style.display = "block";
          var canvasFc = document.getElementById("chart-forecast");
          if (canvasFc) {
            var existingFc = typeof Chart !== "undefined" && Chart.getChart(canvasFc);
            if (existingFc) existingFc.destroy();
            renderLineChart("chart-forecast", cFc, { interaction: { intersect: false, mode: "index" }, scales: { x: { grid: { display: false }, ticks: { maxTicksLimit: 16, maxRotation: 45, color: tickColor } }, y: { grid: { color: gridColor }, ticks: { color: tickColor, stepSize: 5 }, title: { display: true, text: "温度 (" + deg + ")", color: tickColor, font: { size: 11 } } } } });
          };
        } else { if (loadingFc) loadingFc.textContent = "暂无未来 15 天预报"; }
      })
      .catch(function() { var loadingFc = document.getElementById("forecast-loading"); if (loadingFc) loadingFc.textContent = "加载失败，请刷新或检查网络"; });
  })();

  var c25daily = data.chart_2025_daily;
  if (c25daily && c25daily.labels && c25daily.labels.length) {
    var dailyCanvas = document.getElementById("chart-2025-daily");
    var dailyCtx = dailyCanvas.getContext("2d");
    var dailyH = 320;
    var gH = dailyCtx.createLinearGradient(0, 0, 0, dailyH);
    gH.addColorStop(0, "rgba(230,92,43,0.2)"); gH.addColorStop(1, "rgba(230,92,43,0)");
    var gM = dailyCtx.createLinearGradient(0, 0, 0, dailyH);
    gM.addColorStop(0, "rgba(1,115,178,0.2)"); gM.addColorStop(1, "rgba(1,115,178,0)");
    var gL = dailyCtx.createLinearGradient(0, 0, 0, dailyH);
    gL.addColorStop(0, "rgba(2,158,115,0.2)"); gL.addColorStop(1, "rgba(2,158,115,0)");
    var dailyDatasets = [
      { label: "日最高温", data: c25daily.max, borderColor: palette.high, backgroundColor: gH, borderWidth: 2, fill: true, tension: 0.35, pointRadius: 0, pointHoverRadius: 6, hitRadius: 12, pointHoverBackgroundColor: palette.high },
      { label: "日平均温", data: c25daily.mean, borderColor: palette.mean, backgroundColor: gM, borderWidth: 2, fill: true, tension: 0.35, pointRadius: 0, pointHoverRadius: 6, hitRadius: 12, pointHoverBackgroundColor: palette.mean },
      { label: "日最低温", data: c25daily.min, borderColor: palette.low, backgroundColor: gL, borderWidth: 2, fill: true, tension: 0.35, pointRadius: 0, pointHoverRadius: 6, hitRadius: 12, pointHoverBackgroundColor: palette.low }
    ];
    var dailyOpts = Object.assign({}, opts, {
      interaction: { intersect: false, mode: "index" },
      plugins: Object.assign({}, opts.plugins, {
        tooltip: Object.assign({}, opts.plugins.tooltip, {
          callbacks: Object.assign({}, opts.plugins.tooltip.callbacks, {
            title: function(items) { return items.length ? "日期：" + (items[0].label || "") : ""; },
            label: function(ctx) { return ctx.dataset.label + "：" + Number(ctx.parsed.y).toFixed(1) + deg; }
          })
        })
      }),
      scales: {
        x: { grid: { display: false }, ticks: { maxTicksLimit: 14, maxRotation: 45, color: tickColor, font: { size: 11 } } },
        y: { grid: { color: gridColor }, ticks: { color: tickColor, font: { size: 11 }, stepSize: 5 }, title: { display: true, text: "温度 (" + deg + ")", color: tickColor, font: { size: 11 } } }
      }
    });
    new Chart(dailyCanvas, { type: "line", data: { labels: c25daily.labels, datasets: dailyDatasets }, options: dailyOpts });
  }

  var c25 = data.chart_2025;
  if (c25 && c25.labels && c25.labels.length) {
    new Chart(document.getElementById("chart-2025"), {
      type: "line",
      data: { labels: c25.labels, datasets: lineDatasets(["月均最高温", "月均平均温", "月均最低温"], c25.max, c25.mean, c25.min) },
      options: opts
    });
  }

  var c10 = data.chart_10y;
  if (c10 && c10.labels && c10.labels.length) {
    new Chart(document.getElementById("chart-10y"), {
      type: "line",
      data: { labels: c10.labels, datasets: lineDatasets(["年均最高温", "年均平均温", "年均最低温"], c10.max, c10.mean, c10.min) },
      options: opts
    });
  }

  var cab = data.chart_ab;
  if (cab && cab.labels && cab.labels.length) {
    new Chart(document.getElementById("chart-ab"), {
      type: "bar",
      data: {
        labels: cab.labels,
        datasets: [
          { label: "高温异常", data: cab.high, backgroundColor: "rgba(230,92,43,0.85)", borderColor: palette.high, borderWidth: 1 },
          { label: "低温异常", data: cab.low, backgroundColor: "rgba(1,115,178,0.85)", borderColor: palette.mean, borderWidth: 1 }
        ]
      },
      options: Object.assign({}, opts, {
        scales: {
          x: { grid: { display: false }, ticks: { maxRotation: 45, color: tickColor } },
          y: { grid: { color: gridColor }, ticks: { stepSize: 1, color: tickColor }, title: { display: true, text: "天数", color: tickColor, font: { size: 11 } } }
        }
      })
    });
  }

  var c26daily = data.chart_2026_daily;
  if (c26daily && c26daily.labels && c26daily.labels.length) {
    var canvas2026d = document.getElementById("chart-2026-daily");
    if (canvas2026d) {
      var ctx2026d = canvas2026d.getContext("2d");
      var h = 320;
      var gH26 = ctx2026d.createLinearGradient(0, 0, 0, h);
      gH26.addColorStop(0, "rgba(230,92,43,0.2)"); gH26.addColorStop(1, "rgba(230,92,43,0)");
      var gM26 = ctx2026d.createLinearGradient(0, 0, 0, h);
      gM26.addColorStop(0, "rgba(1,115,178,0.2)"); gM26.addColorStop(1, "rgba(1,115,178,0)");
      var gL26 = ctx2026d.createLinearGradient(0, 0, 0, h);
      gL26.addColorStop(0, "rgba(2,158,115,0.2)"); gL26.addColorStop(1, "rgba(2,158,115,0)");
      var ds2026d = [
        { label: "预测最高温", data: c26daily.max, borderColor: palette.high, backgroundColor: gH26, borderWidth: 2, fill: true, tension: 0.35, pointRadius: 0, pointHoverRadius: 6, hitRadius: 12, pointHoverBackgroundColor: palette.high },
        { label: "预测平均温", data: c26daily.mean, borderColor: palette.mean, backgroundColor: gM26, borderWidth: 2, fill: true, tension: 0.35, pointRadius: 0, pointHoverRadius: 6, hitRadius: 12, pointHoverBackgroundColor: palette.mean },
        { label: "预测最低温", data: c26daily.min, borderColor: palette.low, backgroundColor: gL26, borderWidth: 2, fill: true, tension: 0.35, pointRadius: 0, pointHoverRadius: 6, hitRadius: 12, pointHoverBackgroundColor: palette.low }
      ];
      var opts2026d = Object.assign({}, opts, {
        interaction: { intersect: false, mode: "index" },
        plugins: Object.assign({}, opts.plugins, {
          tooltip: Object.assign({}, opts.plugins.tooltip, {
            callbacks: Object.assign({}, opts.plugins.tooltip.callbacks, {
              title: function(items) { return items.length ? "日期：" + (items[0].label || "") : ""; },
              label: function(ctx) { return ctx.dataset.label + "：" + Number(ctx.parsed.y).toFixed(1) + deg; }
            })
          })
        }),
        scales: {
          x: { grid: { display: false }, ticks: { maxTicksLimit: 14, maxRotation: 45, color: tickColor } },
          y: { grid: { color: gridColor }, ticks: { color: tickColor, stepSize: 5 }, title: { display: true, text: "温度 (" + deg + ")", color: tickColor, font: { size: 11 } } }
        }
      });
      new Chart(canvas2026d, { type: "line", data: { labels: c26daily.labels, datasets: ds2026d }, options: opts2026d });
    }
  }

  var c26 = data.chart_2026;
  if (c26 && c26.labels && c26.labels.length) {
    new Chart(document.getElementById("chart-2026"), {
      type: "line",
      data: { labels: c26.labels, datasets: lineDatasets(["预测最高温", "预测平均温", "预测最低温"], c26.max, c26.mean, c26.min) },
      options: opts
    });
  }

  // 今日逐时温度：每次打开页面自动请求当前日期的逐时预报并更新「今日」区块
  (function loadHourlyToday() {
    var wrap = document.getElementById("hourly-today-wrap");
    var loadingEl = document.getElementById("hourly-loading");
    var canvasEl = document.getElementById("chart-hourly-today");
    if (!wrap || !canvasEl) return;
    var apiUrl = "https://api.open-meteo.com/v1/forecast?latitude=23.1291&longitude=113.2644&hourly=temperature_2m&timezone=Asia/Shanghai&forecast_days=2";
    fetch(apiUrl)
      .then(function(r) { return r.json(); })
      .then(function(res) {
        var h = res.hourly;
        if (!h || !h.time || !h.temperature_2m) { if (loadingEl) loadingEl.textContent = "暂无逐时数据"; return; }
        var times = h.time;
        var temps = h.temperature_2m;
        var todayStr = times[0].slice(0, 10);
        var todayIndices = [];
        for (var i = 0; i < times.length; i++) {
          if (times[i].slice(0, 10) === todayStr) todayIndices.push(i);
        }
        if (todayIndices.length === 0) { if (loadingEl) loadingEl.textContent = "今日逐时数据暂无"; return; }
        var labels = [];
        var data = [];
        for (var j = 0; j < todayIndices.length; j++) {
          var idx = todayIndices[j];
          labels.push(times[idx].slice(11, 16));
          data.push(Number(temps[idx].toFixed(1)));
        }
        var tMin = Math.min.apply(null, data);
        var tMax = Math.max.apply(null, data);
        var summaryEl = document.getElementById("today-summary");
        if (summaryEl) summaryEl.innerHTML = "<strong>今日（" + todayStr + "）温度范围：</strong> " + tMin + deg + " ~ " + tMax + deg;
        var adviceEl = document.getElementById("today-advice");
        if (adviceEl) {
          var advice = (tMax >= 35) ? "高温天气，注意防暑降温、减少户外活动，多补水。" :
            (tMax >= 30) ? "天气较热，注意防晒与补水，午后尽量减少暴晒。" :
            (tMin >= 18 && tMax <= 28) ? "气温适宜，早晚可加薄外套，注意增减衣物。" :
            (tMin >= 10 && tMax <= 22) ? "早晚偏凉，建议穿长袖或薄外套。" :
            (tMin >= 0 && tMax <= 15) ? "天气较冷，注意保暖，外出加衣。" :
            (tMin < 0) ? "严寒天气，注意防寒保暖。" : "注意根据体感增减衣物。";
          adviceEl.innerHTML = "<strong>温度建议：</strong>" + advice;
        }
        if (loadingEl) loadingEl.style.display = "none";
        canvasEl.style.display = "block";
        new Chart(canvasEl, {
          type: "line",
          data: {
            labels: labels,
            datasets: [{
              label: "气温",
              data: data,
              borderColor: palette.mean,
              backgroundColor: "rgba(1,115,178,0.2)",
              borderWidth: 2,
              fill: true,
              tension: 0.3,
              pointRadius: 2,
              pointHoverRadius: 6
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            interaction: { intersect: false, mode: "index" },
            plugins: {
              legend: { display: false },
              tooltip: {
                backgroundColor: "#1a2332",
                titleColor: "#e6edf3",
                bodyColor: "#e6edf3",
                borderColor: "#30363d",
                callbacks: {
                  title: function(items) { return items.length ? todayStr + " " + (items[0].label || "") : ""; },
                  label: function(ctx) { return "温度：" + Number(ctx.parsed.y).toFixed(1) + deg; }
                }
              }
            },
            scales: {
              x: { grid: { display: false }, ticks: { maxTicksLimit: 12, color: tickColor, font: { size: 10 } } },
              y: { grid: { color: gridColor }, ticks: { color: tickColor, stepSize: 2 }, title: { display: true, text: "温度 (" + deg + ")", color: tickColor, font: { size: 11 } } }
            }
          }
        });
      })
      .catch(function() { if (loadingEl) loadingEl.textContent = "加载失败，请刷新或检查网络"; });
  })();

})();

  </script>
  <script type="application/json" id="report-context">"报告：广州天气数据报告。广州（约 23.13&#176;N, 113.26&#176;E），数据时段 2016-01-01 至 2025-12-31，生成时间 2026-02-19 05:46。\n今日（2026-02-19）温度范围：14.0～22.9&#176;C；穿衣建议：注意根据体感增减衣物。\n昨日（2026-02-18）温度范围：12.0～22.1&#176;C\n2025年：共365天；年均最高温27.29&#176;C，最低温19.55&#176;C，平均温22.97&#176;C。\n年度最高温日：2025-09-05（38.0&#176;C）；最低温日：2025-02-09（4.5&#176;C）。\n近10年（2016-2025）：日均最高温均值26.7&#176;C，最低温均值19.58&#176;C，平均温22.77&#176;C；年均温趋势约0.5&#176;C/10年。\n异常天气定义：高温异常为日最高温≥33.6&#176;C（95%分位），共187天；低温异常为日最低温≤8.4&#176;C（5%分位），共189天。\n2026年预测方法：基于 2016-2025 年月均值，并叠加约 +0.1&#176;C 年际升温趋势（参考值；未做回归估计）。。\n2026年冬季展望：接近常年，偏暖或偏冷幅度不大；夏季展望：极端高温风险接近常年水平。"</script>
  <!-- 智能客服：支持大模型自然语言查数，未配置 API 时使用 FAQ -->
  <div id="chat-widget">
    <button type="button" id="chat-toggle" aria-label="打开客服">💬</button>
    <div id="chat-panel">
      <div id="chat-header">报告小助手 <button type="button" id="chat-close" aria-label="关闭">×</button></div>
      <div id="chat-messages"></div>
      <div id="chat-quick"></div>
      <form id="chat-form">
        <input type="text" id="chat-input" placeholder="输入问题，例如：数据从哪来？" autocomplete="off" />
        <button type="submit" id="chat-send">发送</button>
      </form>
    </div>
  </div>
  <script>
(function() {
  var CHAT_API_URL = "";  // 大模型接口：留空则仅用 FAQ；部署到 Vercel 并设环境变量 CHAT_API_URL=/api/chat 时自动填入
  var panel = document.getElementById("chat-panel");
  var toggle = document.getElementById("chat-toggle");
  var closeBtn = document.getElementById("chat-close");
  var messages = document.getElementById("chat-messages");
  var quick = document.getElementById("chat-quick");
  var form = document.getElementById("chat-form");
  var input = document.getElementById("chat-input");

  var reportContext = "";
  try {
    var ctxEl = document.getElementById("report-context");
    if (ctxEl && ctxEl.textContent) reportContext = JSON.parse(ctxEl.textContent);
  } catch (e) {}

  var faq = [
    { keys: ["数据来源", "数据从哪", "哪来的", "open-meteo", "api"], answer: "本报告历史数据来自 Open-Meteo Archive API（广州站），今日与未来预报来自 Open-Meteo Forecast API。页面底部有数据来源说明。" },
    { keys: ["今日", "今天", "温度范围", "逐时"], answer: "报告顶部「今日天气与近期预告」中有今日温度范围与穿衣建议；「今日逐时温度预告」图会在打开页面时按当前日期加载逐时预报，悬停可看具体时刻与温度。" },
    { keys: ["昨日", "昨天"], answer: "在「今日天气与近期预告」区块中，今日温度下方会显示昨日（具体日期）的温度范围，便于对比。" },
    { keys: ["未来15天", "15天", "预报"], answer: "「未来 15 天天气预告」图表在打开页面时按当前日期自动加载，数据来自 Open-Meteo Forecast API，悬停可看每日温度。" },
    { keys: ["2025", "去年", "年度"], answer: "「二、历史与年度分析」下「2025 年天气情况」为 2025 年全年统计：年均最高温/最低温/平均温、年度极值日，以及逐日与月度气温图。" },
    { keys: ["近10年", "10年", "趋势", "线性回归", "p值", "显著性"], answer: "近 10 年趋势基于 2016－2025 年数据，用线性回归得到年均温变化（&#176;C/10 年）。若 p < 0.05 表示趋势在统计上显著；p ≥ 0.05 表示不显著，报告中会注明「仅供定性参考」。" },
    { keys: ["高温异常", "低温异常", "95%", "5%", "分位"], answer: "高温异常：日最高温 ≥ 95% 分位（约 33.6&#176;C），表示该日最高温在历史中偏高。低温异常：日最低温 ≤ 5% 分位（约 8.4&#176;C），表示该日最低温在历史中偏低。报告中有各年异常天数的柱状图。" },
    { keys: ["2026", "预测", "月均温", "展望"], answer: "2026 年预测基于 2016－2025 年月均值，并叠加线性回归得到的年际趋势（若显著则采用，否则注明不显著、供参考）。「每日温度预测」由月均温插值得到；「冬夏季展望」为定性描述，不替代气象部门预报。" },
    { keys: ["下载", "表格", "xlsx", "excel"], answer: "点击页面右上角「下载表格数据」可下载 XLSX 表格，内含本报告中的图表数据（如 2025 年逐日、近 10 年、异常天气、2026 预测等），便于在 Excel 中进一步分析。" },
    { keys: ["怎么用", "如何看", "怎么看", "什么意思"], answer: "报告从上到下依次为：近期天气与预告（今日/昨日/逐时/未来15天）、历史与年度分析（2025 年、近 10 年趋势、异常天气、2026 预测与冬夏季展望）。每个图表悬停可看具体数值。有疑问可以继续问我。" }
  ];

  function normalize(s) { return (s || "").toLowerCase().replace(/\s+/g, ""); }
  function findAnswer(q) {
    var nq = normalize(q);
    if (!nq) return null;
    var best = null, bestScore = 0;
    for (var i = 0; i < faq.length; i++) {
      var score = 0;
      for (var j = 0; j < faq[i].keys.length; j++) {
        if (nq.indexOf(normalize(faq[i].keys[j])) !== -1) score++;
      }
      if (score > bestScore) { bestScore = score; best = faq[i]; }
    }
    return best ? best.answer : null;
  }

  function addMsg(text, isUser, isLoading) {
    var div = document.createElement("div");
    div.className = "chat-msg " + (isUser ? "user" : "bot");
    if (isLoading) div.classList.add("loading");
    var bubble = document.createElement("div");
    bubble.className = "bubble";
    bubble.textContent = text;
    div.appendChild(bubble);
    messages.appendChild(div);
    messages.scrollTop = messages.scrollHeight;
    return div;
  }

  var welcome = "你好，我是报告小助手。你可以用自然语言提问，例如：「2025年最热是哪天」「近10年升温多少」「今天适合穿什么」。若已配置大模型接口，我会根据报告数据回答；否则使用预设问答。";
  var quickQuestions = ["2025年最热是哪天？", "近10年升温趋势怎样？", "什么是高温异常？", "今天适合穿什么？"];

  function showWelcome() {
    addMsg(welcome, false);
    quickQuestions.forEach(function(q) {
      var btn = document.createElement("button");
      btn.type = "button";
      btn.textContent = q;
      btn.addEventListener("click", function() { input.value = q; form.dispatchEvent(new Event("submit")); });
      quick.appendChild(btn);
    });
  }

  toggle.addEventListener("click", function() {
    panel.classList.toggle("open");
    if (panel.classList.contains("open") && messages.children.length === 0) showWelcome();
    if (panel.classList.contains("open")) input.focus();
  });
  closeBtn.addEventListener("click", function() { panel.classList.remove("open"); });

  form.addEventListener("submit", function(e) {
    e.preventDefault();
    var q = (input.value || "").trim();
    if (!q) return;
    input.value = "";
    addMsg(q, true);

    if (CHAT_API_URL) {
      var loadingEl = addMsg("思考中…", false, true);
      fetch(CHAT_API_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ question: q, reportContext: reportContext })
      })
        .then(function(r) { return r.json(); })
        .then(function(data) {
          var bubble = loadingEl.querySelector(".bubble");
          if (bubble) bubble.textContent = data.answer || data.error || "回答生成失败";
          loadingEl.classList.remove("loading");
        })
        .catch(function() {
          var bubble = loadingEl.querySelector(".bubble");
          if (bubble) bubble.textContent = findAnswer(q) || "网络或服务异常，请稍后重试或检查是否已配置大模型接口。";
          loadingEl.classList.remove("loading");
        });
    } else {
      setTimeout(function() {
        addMsg(findAnswer(q) || "抱歉，没找到相关说明。请配置 CHAT_API_URL 接入大模型后可自然语言查数，或试试：数据从哪来？什么是高温异常？", false);
      }, 200);
    }
  });
})();
  </script>
</body>
</html>